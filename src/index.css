/* chat-mobile-full.css
   Complete mobile-first CSS for chat UI:
   - Prevents iOS Safari auto-zoom by ensuring inputs have font-size >= 16px
   - Respects safe-area insets (notch/home indicator)
   - Keeps composer fixed and visible above safe area
   - Adds generous messages bottom padding to avoid overlap
   - Provides .keyboard-open and --keyboard-offset hooks for optional JS (VisualViewport)
*/

/* ------------------ Variables ------------------ */
:root{
  --bg: #0b0b10;
  --card: #12121a;
  --muted: #ffffffcc;
  --accent: #007337;
  --border: #1f2330;
  --txt: #ffffff;
  --shadow: 0 8px 24px rgba(0,0,0,.35);
  --glow: 0 0 0 4px rgba(0,115,55,.35);
  --sa-top: env(safe-area-inset-top, 0px);
  --sa-bottom: env(safe-area-inset-bottom, 0px);
  --appbar-h: 56px;
  --composer-h: 68px;
  --footer-h: 54px;
  --max-chat-width: 860px;
  /* Optional variable updated by JS if you later add VisualViewport support */
  --keyboard-offset: 0px;
}

/* ------------------ Base resets & iOS fixes ------------------ */
* { box-sizing: border-box; touch-action: manipulation; }
html, body, #root { height: 100%; margin: 0; }
html { -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }

/* iOS fill-available */
@supports (-webkit-touch-callout: none) {
  html { height: -webkit-fill-available; }
  body { min-height: -webkit-fill-available; }
  .page { min-height: -webkit-fill-available; }
}

/* ------------------ Body & typography ------------------ */
body {
  background: var(--bg);
  color: var(--txt);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans", Arial, sans-serif;
  font-size: 15px;
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  color-scheme: dark;
}

/* ------------------ Layout & main elements ------------------ */
.page { min-height: 100dvh; display: flex; flex-direction: column; position: relative; }

/* Header: keep compact and pinned */
.header {
  position: sticky;
  top: 0;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: calc(10px + var(--sa-top)) 16px 10px;
  min-height: calc(var(--appbar-h) + var(--sa-top));
  border-bottom: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(18,18,26,.95), rgba(18,18,26,.6) 60%, transparent);
  backdrop-filter: saturate(120%) blur(6px);
  -webkit-backdrop-filter: saturate(120%) blur(6px);
  gap: 12px;
}
.brand { display: flex; gap: 10px; align-items: center; min-width: 0; }
.logo { width: 34px; height: 34px; object-fit: contain; border-radius: 8px; box-shadow: var(--glow); }
.tag  { margin: 0; color: var(--muted); font-size: 12px; white-space: nowrap; text-overflow: ellipsis; overflow: hidden; }

/* Chat container */
.chat {
  width: 100%;
  max-width: var(--max-chat-width);
  margin: 0 auto;
  padding: 12px 14px 0;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  padding-bottom: calc(var(--composer-h) + var(--footer-h) + var(--sa-bottom) + 12px);
  box-sizing: border-box;
}

/* Messages scrolling area */
.messages {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 10px 0;
  overflow: auto;
  overscroll-behavior: contain;
  scroll-behavior: smooth;
  flex: 1;
  min-height: 0;
  /* generous bottom padding to avoid overlap with composer or buggy keyboards */
  padding-bottom: calc(var(--composer-h) + var(--footer-h) + var(--sa-bottom) + var(--keyboard-offset) + 48px);
}
.messages::-webkit-scrollbar{height:10px;width:10px}
.messages::-webkit-scrollbar-thumb{background:#1b1b24;border:2px solid transparent;border-radius:8px;background-clip:padding-box}
.messages::-webkit-scrollbar-thumb:hover{background:#242433}
.messages::-webkit-scrollbar-track{background:transparent}

/* ------------------ Bubbles ------------------ */
.bubble {
  background: var(--card);
  border: 1px solid var(--border);
  padding: 12px 14px;
  border-radius: 14px;
  max-width: 94%;
  box-shadow: var(--shadow);
  font-size: 14px;
  line-height: 1.55;
  word-wrap: break-word;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
}
.bubble .role { font-size: 12px; margin-bottom: 5px; }
.bubble.user { align-self: flex-end; background: #0f3a23; border-color: #1a4d2f; }
.bubble.assistant { align-self: flex-start; background: var(--card); border-color: var(--border); }

/* ------------------ Buttons / utilities ------------------ */
.btn {
  appearance: none; -webkit-appearance: none; cursor: pointer;
  background: var(--accent); color: #fff;
  padding: 10px 14px; border-radius: 10px;
  font-weight: 700; font-size: 14px; line-height: 1.35;
  transition: box-shadow .18s ease, transform .05s ease, opacity .2s ease, background .2s ease, border-color .2s ease;
  box-shadow: 0 0 0 0 rgba(0,115,55,0); border: 0; min-height: 40px;
  -webkit-tap-highlight-color: transparent;
}
.btn:hover { box-shadow: 0 0 0 4px rgba(0,115,55,.12); }
.btn:active { transform: translateY(1px); }
.btn[disabled] { opacity: .6; cursor: not-allowed; }
.btn-outline { background: transparent; color: var(--txt); border: 1px solid var(--border); box-shadow: none; }
.btn-ghost   { background: transparent; color: var(--muted); border: 1px solid var(--border); }
.btn-block   { width: 100%; }

/* ------------------ Composer (fixed) ------------------ */
/* Keep composer >= 16px inputs to prevent iOS zoom */
.composer {
  position: fixed;
  left: 0;
  right: 0;
  /* composer is offset by footer + safe-area + optional keyboard offset */
  bottom: calc(var(--footer-h) + var(--sa-bottom) + var(--keyboard-offset));
  z-index: 100;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  padding: 10px 14px;
  border-top: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(11,11,16,0), rgba(11,11,16,.95));
  backdrop-filter: saturate(120%) blur(8px);
  -webkit-backdrop-filter: saturate(120%) blur(8px);
  max-width: var(--max-chat-width);
  margin: 0 auto;
  box-sizing: border-box;
  transition: bottom .12s ease;
}

/* critical: iOS Safari auto-zoom prevention */
.composer input,
.composer textarea,
input[type="text"],
input[type="search"],
input[type="email"],
input[type="tel"],
input[type="url"] {
  font-size: 16px;                 /* >=16px prevents iOS zoom on focus */
  -webkit-text-size-adjust: 100%;
  -moz-text-size-adjust: 100%;
  appearance: none;
  -webkit-appearance: none;
  min-height: 44px;
  padding: 0 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--card);
  color: var(--txt);
  line-height: 1.4;
}

/* composer button */
.composer .btn {
  height: 44px;
  padding: 0 14px;
  min-width: 64px;
  border-radius: 12px;
}

/* Hints toolbar above composer (fixed) */
.hints {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  padding: 8px 14px 10px;
  position: fixed;
  left: 0;
  right: 0;
  bottom: calc(var(--composer-h) + var(--footer-h) + var(--sa-bottom) + var(--keyboard-offset));
  z-index: 90;
  max-width: var(--max-chat-width);
  margin: 0 auto;
  box-sizing: border-box;
  transition: bottom .12s ease;
}
.hint {
  font-size: 13px;
  color: var(--muted);
  border: 1px dashed var(--border);
  padding: 7px 11px;
  border-radius: 999px;
  cursor: pointer;
  white-space: nowrap;
  transition: border-color .15s ease, color .15s ease, background .15s ease;
  background: var(--card);
}
.hint:hover { border-style: solid; color: var(--accent); background: #111218; }

/* Footer (keeps at bottom; keyboard offset can move it up if you set --keyboard-offset) */
.footer {
  position: fixed;
  left: 0;
  right: 0;
  bottom: calc(var(--keyboard-offset));
  z-index: 80;
  padding: 12px 14px calc(12px + var(--sa-bottom));
  border-top: 1px solid var(--border);
  color: var(--muted);
  font-size: 12px;
  background: rgba(12,12,18,.95);
  backdrop-filter: saturate(120%) blur(8px);
  -webkit-backdrop-filter: saturate(120%) blur(8px);
  max-width: var(--max-chat-width);
  margin: 0 auto;
  box-sizing: border-box;
  transition: bottom .12s ease;
}

/* ------------------ Keyboard open hook (for optional JS) ------------------ */
/* If you add JS that measures keyboard height, set --keyboard-offset to that px value.
   Example: document.documentElement.style.setProperty('--keyboard-offset', '280px')
*/
body.keyboard-open .composer,
body.keyboard-open .hints,
body.keyboard-open .footer {
  transition: none; /* temporarily disable complex transitions during keyboard animation */
}

/* ------------------ Small-screen responsive tweaks ------------------ */
@media (max-width: 640px) {
  :root{ --appbar-h:60px; --composer-h:64px; --footer-h:50px; --max-chat-width:100%; }
  .header { padding: calc(10px + var(--sa-top)) 12px 10px; }
  .chat { padding: 10px 12px 0; padding-bottom: calc(var(--composer-h) + var(--footer-h) + var(--sa-bottom) + 40px + 20px); }
  .bubble { max-width: 96%; }
  .logo { width: 32px; height: 32px; }
  .composer { padding: 8px 12px; gap: 8px; }
  .composer input { height: 48px; min-height: 48px; padding: 0 14px; border-radius: 12px; }
  .composer .btn { height: 48px; padding: 0 14px; border-radius: 12px; }
  .hints { padding: 6px 12px 8px; }
  .footer { padding: 10px 12px calc(10px + var(--sa-bottom)); }
}

@media (max-width: 480px) {
  :root { --appbar-h: 68px; --composer-h: 76px; --footer-h: 54px; }
  html, body { font-size: 16px; line-height: 1.6; }
  .header { padding: calc(12px + var(--sa-top)) 12px 12px; }
  .chat { padding: 12px 12px 0; height: calc(100vh - var(--appbar-h) - var(--sa-top)); }
  .messages { gap: 14px; margin-bottom: calc(var(--composer-h) + var(--footer-h) + 60px + var(--sa-bottom)); padding-bottom: 20px; }
  .bubble { max-width: 96%; padding: 14px 16px; border-radius: 16px; font-size: 15px; line-height: 1.6; }
  .composer { grid-template-columns: 1fr auto; gap: 10px; padding: 10px 12px; }
  .composer input { height: 48px; min-height: 48px; padding: 0 14px; border-radius: 12px; font-size: 15px; line-height: 1.45; }
  .composer .btn { height: 48px; padding: 0 14px; font-size: 15px; border-radius: 12px; }
  .hints { gap: 10px; padding: 10px 12px 12px; }
  .hint { font-size: 14px; padding: 8px 12px; border-radius: 999px; }
  .footer { font-size: 14px; padding: 16px 12px calc(12px + var(--sa-bottom)); }
}

@media (max-width: 380px) {
  .composer { grid-template-columns: 1fr; gap: 6px; align-items: stretch; }
  .composer .btn { width: 100%; }
}

/* ------------------ Accessibility / touch affordances ------------------ */
button, .hint { -webkit-tap-highlight-color: transparent; touch-action: manipulation; }
input, select, textarea, button { font-family: inherit; color: inherit; -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }

/* Remove number spinners */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; appearance: none; margin: 0; }
input[type="number"] { -moz-appearance: textfield; appearance: textfield; }

/* ------------------ Helpful testing classes ------------------ */
/* Use these in development to force states while testing on desktop */
.debug-force-keyboard .composer { bottom: calc(var(--footer-h) + var(--sa-bottom) + 300px); }
.debug-force-sa .composer { bottom: calc(var(--footer-h) + var(--sa-bottom) + 20px); }

/* ------------------ Notes (keep for devs) ------------------
1) The single most important rule to avoid iOS auto-zoom is input font-size >= 16px.
2) Pure CSS cannot reliably detect the mobile keyboard height. To perfectly pin the composer above the keyboard you need a tiny JS snippet that uses VisualViewport (recommended) and sets:
   document.documentElement.style.setProperty('--keyboard-offset', keyboardHeight + 'px');
   and add document.body.classList.add('keyboard-open') while keyboard is visible.
3) If you can't add JS, this CSS uses generous bottom padding on .messages to reduce overlap on most devices.
4) Keep meta viewport as: <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"> (avoid maximum-scale=1 unless you want to block pinch-zoom).
*/
